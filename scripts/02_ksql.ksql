create stream ba  (tid varchar, batt INTEGER, lon DOUBLE, lat DOUBLE, tst BIGINT, alt INTEGER) with (kafka_topic = 'mq_vc_bytearray', value_format='JSON');


create stream runner_location with (value_format='JSON') as
select split(rowkey, '/')[2] as who
, tst as event_time
, cast(lat as varchar) ||','||cast(lon as varchar) as LOCATION
, alt
, batt
from ba;

